<p style="color: green"><%= notice %></p>

<h1>Servers</h1>
<%= form_tag servers_path, method: 'GET' do |f| %>
  has_waf: <%= select_tag "is_detected_waf", options_for_select(["all", "yes", "no"], params["is_detected_waf"] ) %>
  wappalyzer: <%= select_tag "is_detected_by_wappalyzer", options_for_select(["all", "yes", "no"], params["is_detected_by_wappalyzer"]  ) %>
  ehole: <%= select_tag "is_detected_by_ehole", options_for_select(["all", "yes", "no"], params["is_detected_by_ehole"]  ) %>
  the_harvester: <%= select_tag "is_detected_by_the_harvester", options_for_select(["all", "yes", "no"], params["is_detected_by_the_harvester"]  ) %>
  nmap: <%= select_tag "is_detected_by_nmap", options_for_select(["all", "yes", "no"], params["is_detected_by_nmap"]  ) %>
  level: <%= text_field_tag "level", params[:level], placeholder: '0,1,2... small is more important' %>
  order by: <%= text_field_tag "order_by", params[:order_by], placeholder: 'id desc' %>
  <%= submit_tag %>
<% end %>

<%= paginate @servers %>, total: <%= @servers.count %>
<table class='table table-bordered table-hovered table-striped'>
  <tr>
    <td style='width:50px'> id </td>
    <td style='width:50px'> name </td>
    <td style='width: 200px'> dig_result</td>
    <td style='width: 200px'> wafwoof_result</td>
    <td style='width: 400px'> wappalyzer_result </td>
    <td style='width: 200px'> ehole_result</td>
    <td style='width: 50px'> nmap_result</td>
    <td style='width: 150px'> title </td>
    <td style='width: 50px'> level </td>
    <td style='width: 50px'> comment </td>
    <td style='width: 50px'> time </td>
  </tr>
  <% @servers.each do |server| %>
  <tr>
    <td> <%= server.id %> </td>
    <td>
      <%= server.name %> <br/>
    </td>
    <td>
      <pre><%= server.dig_result %>
      </pre>
      <br/>
      pure ip: <%= server.pure_ip %>
    </td>
    <td>
      <%= server.wafwoof_result %>
    </td>
    <td>
      <%= server.wappalyzer_result %>
    </td>
    <td>
      <%= server.ehole_result%>
    </td>
    <td>
      <%# server.ip.nmap_result %>
    </td>
    <td>
      <%= server.title %>
    </td>
    <td><%= server.level %> </td>
    <td><%= server.comment %> </td>
    <td><%= server.created_at %> <br/><%= server.created_at %> </td>
    <td>
      <%= link_to "Show", server %>
      <%= link_to "Edit", server %>
    </td>
  </tr>
  <% end %>
</table>

<%= paginate @servers %>
<%= link_to "New server", new_server_path %>

<style>
table {
  border: 1px solid black;
  table-layout: fixed;
  width: 200px;
}

th,
td {
  border: 1px solid black;
  width: 100px;
  overflow: hidden;
}
</style>
